<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to R - part 3</title>
    <meta charset="utf-8" />
    <meta name="author" content="Tiago Nardi" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/viz/viz.js"></script>
    <link href="libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding/grViz.js"></script>
    <link rel="stylesheet" href="extra.css" type="text/css" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introduction to R - part 3
## ðŸ§‰
### Tiago Nardi
### University of Pavia

---





class: inverse, middle, center
# Plot design
---
## Statistical analysis - the basics
Statistical analysis is the science of collecting, exploring and presenting large amounts of data to discover underlying patterns and trends

Statistical analysis can be broken down into five discrete steps, as follows:

1. Describe the nature of the data to be analyzed
2. Explore the relation of the data to the underlying population
3. Create a model to summarize understanding of how the data relates to the underlying
population
4. Prove (or disprove) the validity of the model
5. Employ predective analyses to run scenarios that will help guide future actions

---
## Statistical analysis - the basics
Variable: characteristic detected on each statistical unit, which can take different values in the different statistical units

Observation: value assumed by a variable in a given statistical unit
<div id="htmlwidget-1fe09bca69cc6bb89e9f" style="width:504px;height:504px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fe09bca69cc6bb89e9f">{"x":{"diagram":"digraph flowchart {\n  node [fontname = arial, shape = box, color=Steelblue]\n  tab1 [label = \"Variables\"]\n  tab2 [label = \"Quantitative Variables\"]\n  tab3 [label = \"Qualitative variables\"]\n  tab4 [label = \"Discrete\"]\n  tab5 [label = \"Continuous\"]\n  tab6 [label = \"Nominal\"]\n  tab7 [label = \"Ordinal\"]\n  \n  tab1 -> tab2;\n  tab1 -> tab3;\n  tab2 -> tab4;\n  tab2 -> tab5;\n  tab3 -> tab6;\n  tab3 -> tab7\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
---
## Variables classification
### Quantitative variables
  expressed by numbers
- Discrete: can only be particular values within a certain interval (often derived from counts). They are natural numbers
  - Number of colonies per plate
  - Number of chromosomes of a species
- Continuous: can be any value within a given range (they come from measurements). They
are real numbers
  - Weight
  - Height

---
## Variables classification
### Qualitative variables
- #### Nominal: are characterized by different modes that can not be ordered:
  - Sex: male / female
  - Survival: alive / dead
  - Blood groups: A, B, AB, 0
- #### Ordinal: are characterized by different modes that can be ordered:
  - Obesity levels: overweight, obesity I, obesity II, obesity III
  - Intensity of reaction to an antigen: zero, medium, high
  - Educational qualification: compulsory school, bachelor, master, PhD
---
<div id="htmlwidget-ec0e1e2f99a82c1c6779" style="width:504px;height:504px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ec0e1e2f99a82c1c6779">{"x":{"diagram":"digraph flowchart {\n  node [fontname = arial, shape = box, color=Steelblue]\n  tab1 [label = \"Quantitative Variables\"]\n  tab2 [label = \"Check if the variable has a normal distribution\", color=Red]\n  tab3 [label = \"Shapiro-Wilk Normality Test\"]\n  tab4 [label = \"p-value < 0.05\"]\n  tab5 [label = \"Wilcoxon Test\"]\n  tab6 [label = \"p-value >= 0.05\"]\n  tab7 [label = \"Studentâ€™s t Test\"]\n  \n  tab1 -> tab2;\n  tab2 -> tab3;\n  tab3 -> tab4;\n  tab4 -> tab5;\n  tab3 -> tab6;\n  tab6 -> tab7\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
---
## Statistical analysis - the basics
How to test if the difference between the MEAN VALUE of quantitative variables is statistically significant BETWEEN the two groups
Quantitative variable
Check if the variable has a normal distribution
Shapiro-Wilk Normality Test
p-value &lt; 0.05p-value &gt;= 0.05
Wilcoxon TestStudentâ€™s t Test
---
## Statistical analysis - the basics
What is a normal distribution?

The normal distribution is a continuous probability distribution that is symmetrical on both sides of the mean, so the right side of the center is a mirror image of the left side

The area under the normal distribution curve represents probability and the total area under the curve sums to one.

Most of the continuous data values in a normal distribution tend to cluster around the
mean, and the further a value is from the mean, the less likely it is to occur

---
## Statistical analysis - the basics
How to test for normal distribution:
shapiro.test(numeric_vector)
â€¢ The null hypothesis for this test is that the data are normally distributed
â€¢ The alternative hypothesis for this test is that the data are not normally distributed

For this test, the p-value is the probability that the null hypothesis is true. If the p-value
is less than 0.05, then the null hypothesis is rejected (because the probability is &lt; 5%)
p-value calculated &lt; 0.05
p-value calculated &gt;= 0.05
the variable does not have a Normal distribution
the variable has a Normal distribution
---
## Statistical analysis - the basics
How to test if two or more mean values are statistically different:
wilcox.test(first_numeric_vector, second_numeric_vector)
â€¢ The null hypothesis for this test is that the two mean values are not statistically
different
â€¢ The alternative hypothesis for this test is that the two mean values are statistically
different
For this test, the p-value is the probability that the null hypothesis is true. If the p-value
is less than 0.05, then the null hypothesis is rejected (because the probability is &lt; 5%)
p-value calculated &lt; 0.05
p-value calculated &gt;= 0.05
mean values are significantly different
mean values are not significantly differentStatistical analysis - the basics
Example:
S.aures vs M.tuberculosis: is the genome size significantly different between the two species?
df &lt;- read.table("PATRIC_Statistics.csv",header = T,stringsAsFactors = F)
str(df)
table(df$Bacterium)
tuberculosis &lt;- subset(stat,Bacterium=="M_tuberculosis")
tuberculosis&lt;-droplevels(tuberculosis)
aureus &lt;- subset(stat,Bacterium=="S_aureus")
aureus&lt;-droplevels(aureus)
g_tuberculosis &lt;- tuberculosis$Genome.Length
# quantitative variable
g_aureus &lt;- aureus$Genome.Length
# quantitative variable
shapiro.test(g_aureus) #the variable DOES NOT have a Normal distribution
shapiro.test(g_tuberculosis) #the variable DOES NOT have a Normal distribution
wilcox.test(g_aureus,g_tuberculosis) #p-value &lt; 2.2e-16
Genome size mean value is significantly different between the two species
---
## Statistical analysis - the basics
<div id="htmlwidget-ae44f2d99aacce735ff8" style="width:504px;height:504px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ae44f2d99aacce735ff8">{"x":{"diagram":"digraph flowchart {\n  node [fontname = arial, shape = box, color=Steelblue]\n  tab1 [label = \"Qualitative Variables\"]\n  tab2 [label = \"Chi-Square Test\"]\n  tab3 [label = \"p-value < 0.05\",color=red]\n  tab4 [label = \"p-value >= 0.05\",color=red]\n\n  tab1 -> tab2;\n  tab2 -> tab3;\n  tab2 -> tab4\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>

---
How to test whether there is an association between categorical variables:
Qualitative variable
Chi-square Test
p-value &lt; 0.05
p-value &gt;= 0.05Statistical analysis - the basics
Chi-square test: it determines whether there is an association between categorical variables (i.e.,
whether the variables are independent or related). This test utilizes a contingency table to analyze the
data. A contingency table (or two-way table) is an arrangement in which data is classified according
to two categorical variables. The categories for one variable appear in the rows, and the categories for
the other variable appear in columns. Each variable must have two or more categories. Each cell
reflects the total count of cases for a specific pair of categories
â€¢ The null hypothesis for this test is that the categorical variables are indipendent (no correlation)
â€¢ The alternative hypothesis for this test is that the categorical variables are correlated
For this test, the p-value is the probability that the null hypothesis is true. If the p-value is less
than 0.05, then the null hypothesis is rejected (because the probability is &lt; 5%)Statistical analysis - the basics
How to create a contingency table:
contingency_table &lt;- table(dataframe_name$column_1, dataframe_name$column_2)
chisq.test(contingency_table)
p-value calculated &lt; 0.05The variables are dependent and related
p-value calculated &gt;= 0.05The variables are independentStatistical analysis - the basics
Example:
S.aures vs M.tuberculosis: is there a correlation between the microorganism and the outcome?
t &lt;- table(df$Bacterium,df$Outcome)
chisq.test(t)
The test is significant (p-vale &lt; 0.05). The outcome is correlated with the microorganism

---
# Histograms
.pull-left[
Histogram plot with default values

```r
db &lt;- read.csv("patric_redux.csv")
```
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(img/midi_trans.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 110px;
  height: 128px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
