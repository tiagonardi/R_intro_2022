<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to R - part 3</title>
    <meta charset="utf-8" />
    <meta name="author" content="Tiago Nardi" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="extra.css" type="text/css" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introduction to R - part 3
## ðŸ§‰
### Tiago Nardi
### University of Pavia

---






class: inverse, middle, center
# Plot design
---
# Histograms
A histogram is a representation of the distribution of numerical data

The entire range of values is divided into intervals and then the function counts how many values fall into each interval
---
# Histograms
.pull-left[
Histogram plot with default values

```r
db &lt;- read.csv("patric_redux.csv")
hist(db$GC.Content)
```
]
.pull-right[
![](R_lesson3_files/figure-html/unnamed-chunk-2-1.png)&lt;!-- --&gt;
]
---
# Histograms


```r
hist(dataframe_name$column,
     breaks = "value", col = "colour_name",
     border = "colour_name", main = "Title", 
     xlab = "x_name", ylab = "y_name")
```
breaks: a single number giving the number of cells for the histogram

col: a colour to be used to fill the bars

border: the color of the border around the bars. The default is to use the standard foreground color

main, xlab, ylab: these arguments give labels to title and axis
---
class: inverse
# Exercise
.pull-left[

```r
hist(dataframe_name$column,
     breaks = "value",
     col = "colour_name",
     border = "colour_name", 
     main = "Title", 
     xlab = "x_name", 
     ylab = "y_name")
```
#### Try to get a histogram using the patric_redux.csv, draw the genome length, use appropriate labels and use a colour
]
.pull-right[
![](img/cowboy-bebop-cowboy.gif)]
---
![](R_lesson3_files/figure-html/hist2-1.png)&lt;!-- --&gt;


```r
hist(db$Genome.Length, breaks = 20, main = "Genome Length Distribution",
     col = "#32577F",border="black",xlab="Length")
```
---
## Saving graphs
To save a graph

```r
pdf("Graph_name.pdf")
graph_command # any graph, including hist()
dev.off()
```

This will save whatever you draw (*graph_command*) in your __present working directory__

You can also use the *export* function in the __Plot tab__
---
## Barplot
A barplot shows the relationship between categorical variables. Each variable is
represented as a bar. The size of the bar represents its numeric value
In R, barplot() function computes a barplot of the given grouped values
barplot(table, col = "colour_name", beside = TRUE, cex.names = number, las = 2, main
= "Title", xlab = "x_name", ylab = "y_name")
table: contingency table of the counts at each combination of factor levels
col: a colour to be used to fill the bars
beside = TRUE: the values in each column are juxtaposed rather than stacked
las = 2: make all labels perpendicular to axis
main, xlab, ylab: these arguments give names to title and axisBarplot
For barplots, we can also specify a legend:
legend (x, legend, fill = "colour_name", col = "colour_name", bg = "colour_name", pch
= number)
x: co-ordinates to be used to position the legend
legend: the text of the legend
fill: colors to use for filling the boxes beside the legend text
col: colors of lines and points beside the legend text
bg: the background color for the legend box
pch:the plotting symbols appearing in the legendBarplot
Example:
t &lt;- table(db$Sex,db$Isolation.Site)
barplot(t,las=2, main = "Sex-Body",col = c("black","red"))
legend("topright", c("Female", "Red"), col = c("black","red"), pch = 19)Scatter plot
A scatter plot shows the relationship between two numerical variables. The data are
displayed as a collection of points, each having the value of one variable determining the
position on the horizontal axis and the value of the other variable determining the
position on the vertical axis
In R, we can use the generic function plot()
plot(x,y, col = "colour_name",main = "Title", xlab = "x_name", ylab = "y_name")
x,y: the two numerical variables
col: a colour to be used to fill the bars
main, xlab, ylab: these arguments give names to title and axisScatter plot
Example:
table(db$Quality)
db$Quality &lt;- as.factor(db$Quality)
str(db$Quality)
plot(db$Genome.Length,db$Contigs,xlab = "Length",ylab = "Contigs",
main="Length-Contigs",col=c("red","black","green")[db$Quality]))
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(img/midi_trans.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 110px;
  height: 128px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
