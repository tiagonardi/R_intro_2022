---
title: "Introduction to R - part 3"
subtitle: "ðŸ§‰"
author: "Tiago Nardi"
institute: "University of Pavia"
output:
  xaringan::moon_reader:
    css: [extra.css, xaringan-themer.css]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    includes:
      after_body: insert-logo.html
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

```
```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
  #style_mono_accent(
  style_duo(
  primary_color = "#f2DB86",
  #base_color = "#B2284B",
  secondary_color = "#32577F",

)
library(gt)

# style_duo_accent(primary_color = "#002fa7", secondary_color = "#C5A900")

```
class: inverse, middle, center
# Plot design
---
# Histograms
A histogram is a representation of the distribution of numerical data

The entire range of values is divided into intervals and then the function counts how many values fall into each interval
---
# Histograms
.pull-left[
Histogram plot with default values
```{r hist1, fig.show = 'hide'}
db <- read.csv("patric_redux.csv")
hist(db$GC.Content)
```
]
.pull-right[
```{r ref.label='hist1',echo = FALSE, dev.args = list(bg = "transparent")}
```
]
---
# Histograms

``` {r , eval= FALSE}
hist(dataframe_name$column,
     breaks = "value", col = "colour_name",
     border = "colour_name", main = "Title", 
     xlab = "x_name", ylab = "y_name")
```
breaks: a single number giving the number of cells for the histogram

col: a colour to be used to fill the bars

border: the color of the border around the bars. The default is to use the standard foreground color

main, xlab, ylab: these arguments give labels to title and axis
---
class: inverse
# Exercise
.pull-left[
``` {r , eval= FALSE}
hist(dataframe_name$column,
     breaks = "value",
     col = "colour_name",
     border = "colour_name", 
     main = "Title", 
     xlab = "x_name", 
     ylab = "y_name")
```
#### Try to get a histogram using the patric_redux.csv, draw the genome length, use appropriate labels and use a colour
]
.pull-right[
![](img/cowboy-bebop-cowboy.gif)]
---
```{r hist2, echo = FALSE, dev.args = list(bg = "transparent")}
hist(db$Genome.Length, breaks = 20, main = "Genome Length Distribution",
     col = "#32577F",border="black",xlab="Length")
```

```{r, eval = FALSE}
hist(db$Genome.Length, breaks = 20, main = "Genome Length Distribution",
     col = "#32577F",border="black",xlab="Length")
```
---
## Saving graphs
To save a graph
```{r, eval=FALSE}
pdf("Graph_name.pdf")
graph_command # any graph, including hist()
dev.off()
```

This will save whatever you draw (*graph_command*) in your __present working directory__

You can also use the *export* function in the __Plot tab__
---
## Barplot
A barplot shows the relationship between categorical variables. Each variable is
represented as a bar, and the bar size represents its numeric value


In R, barplot() function computes a barplot of the given grouped values

For the bar height you need a quantitative variable

For the bar name you need a qualitative variable
---
class: hide-logo, inverse
.pull-left[
### Try to make one barplot, using the subsetted table, with the *ID* as qualitative and *Contigs* as quantitative variable]
.pull-right[
![](img/cowboy-bebop-cowboy.gif)]
```{r, eval=TRUE}
# I'm using a smaller table for readability sake
db_sub <- subset(
  db,
  db$Isolation_location == "Barad-dur" | 
    db$Isolation_location == "Isengard" )
```

```{r eval=FALSE}
barplot(
  height=quantitative_variable,
  names=qualitative_variable)
```
---
## Barplot
```{r, eval=TRUE, dev.args = list(bg = "transparent"),echo=FALSE}
barplot(height=db_sub$Contigs, names=db_sub$ID,col = "#32577F")
```
---
## Barplot
```{r, eval=FALSE}
barplot(table, col = "colour_name",
        horiz = T, main = "Title",
        xlab = "x_name", ylab = "y_name",
        width=c(0.1,0.2,3,1.5,0.3),
        col=c("color","#HEX"), space=c(1,3))
```
You can edit labels, as you have done before with the histogram, changing bar colours, display the bars horizontally, modify the space between the bars or even their width

Remember that you can check the __help__ using *?barplot*

---
```{r, eval=TRUE, echo=FALSE,dev.args = list(bg = "transparent")}
barplot(height=db_sub$PATRIC.CDS,names=db_sub$ID,
        horiz=T,
        width=c(0.1,0.2,0.3,1.4,0.3),
        col=c("#00A0B0","#6A4A3C","#CC333F","#EB6841","#EDC951"))
```
---
## Scatter plot
A scatter plot shows the relationship between two numerical variables

The data are displayed as a collection of points, each having one variable determining the position on the horizontal axis and theother variable determining the
position on the vertical axis

In R, we can use the generic function *plot()*
```{r , eval=FALSE}
plot(x,y, col = "colour_name",
main = "Title", xlab = "x_name", ylab = "y_name")
```
x,y: the two numerical variables

col: a colour to be used to fill the bars

main, xlab, ylab: these arguments give names to title and axis
---

```{r}
plot(db$Genome.Length,db$Contigs, col=db$Host_ethnicity)
```

---

---
## Scatter plot
Example:
table(db$Quality)
db$Quality <- as.factor(db$Quality)
str(db$Quality)
plot(db$Genome.Length,db$Contigs,xlab = "Length",ylab = "Contigs",
main="Length-Contigs",col=c("red","black","green")[db$Quality]))